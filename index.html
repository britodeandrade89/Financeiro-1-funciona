<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle Financeiro Bispo-Brito</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#14b8a6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Finanças AI">
    <link rel="apple-touch-icon" href="icon.svg">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.21.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "firebase/app": "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js",
    "firebase/auth": "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js",
    "firebase/firestore": "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js",
    "firebase/": "https://aistudiocdn.com/firebase@^12.5.0/"
  }
}
</script>
</head>
<body>
    <div id="app-container">
        <!-- BANK STYLE HEADER -->
        <header class="header">
            <div class="header-top-row">
                <button id="menuBtn" class="icon-btn menu-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                </button>
                <div class="user-greeting-wrapper">
                    <div id="headerGreeting" class="greeting-text">Olá</div>
                    <div id="currentDateDisplay" class="date-text">Carregando data...</div>
                </div>
                <div class="header-actions">
                     <button id="open-ai-btn-header" class="icon-btn ai-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3c-1.2 0-2.4.6-3 1.7A3.6 3.6 0 0 0 8.3 9c.5 1.1 1.4 2 2.7 2s2.2-.9 2.7-2c.1-.4.2-.8.3-1.3.6-1.1 0-2.3-1-3.1-.3-.2-.6-.3-1-.3z"></path><path d="M12 21c-1.2 0-2.4-.6-3-1.7A3.6 3.6 0 0 1 8.3 15c.5-1.1 1.4-2 2.7-2s2.2.9 2.7 2c.1.4.2.8.3 1.3.6 1.1 0 2.3-1 3.1-.3-.2-.6-.3-1 .3z"></path><path d="M3 12c0-1.2.6-2.4 1.7-3A3.6 3.6 0 0 1 9 8.3c1.1.5 2 1.4 2 2.7s-.9 2.2-2 2.7c.4.1.8.2-1.3.3-1.1.6-2.3 0-3.1-1 .2-.3-.3-.6-.3-1z"></path><path d="M21 12c0-1.2-.6-2.4-1.7-3A3.6 3.6 0 0 0 15 8.3c-1.1.5-2 1.4-2 2.7s.9 2.2 2 2.7c.4.1.8.2 1.3.3 1.1.6 2.3 0-3.1-1 .2-.3.3-.6-.3-1z"></path></svg>
                     </button>
                </div>
            </div>

            <div class="header-balance-section">
                <span class="balance-label">Saldo disponível</span>
                <div class="balance-wrapper">
                    <span id="headerBalanceValue" class="balance-value">R$ 0,00</span>
                    <button id="toggleBalanceBtn" class="icon-btn toggle-eye">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                    </button>
                </div>
            </div>

            <div class="month-selector-bar">
                <button class="month-btn prev-month">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
                </button>
                <span id="monthDisplay" class="month-display">Mês Atual</span>
                <button class="month-btn next-month">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                </button>
            </div>
        </header>

        <!-- SIDEBAR -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>
        <div id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h2>Menu</h2>
                <button id="closeSidebarBtn" class="action-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            <div class="sidebar-content">
                <div class="section">
                    <div class="section-header"><h2 class="section-title">Contas</h2></div>
                    <div id="bankAccountsList"></div>
                    <div class="accounts-total"><span>Saldo Total</span><span id="accountsTotalValue">R$ 0,00</span></div>
                    <div style="padding: 1.5rem;"><button id="add-account-btn" class="btn btn-secondary" style="width: 100%; justify-content: center;"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Adicionar Conta</button></div>
                </div>
                <div class="section">
                    <div class="section-header"><h2 class="section-title">Sincronização na Nuvem</h2></div>
                    <div class="sync-config-section">
                        <p><strong>Status:</strong> <span id="sync-status-text"></span></p>
                        <div id="user-id-container" style="display: none;"><p><strong>ID do Usuário:</strong> <code id="user-id-text"></code></p></div>
                        <p id="sync-status-info"></p>
                        <button id="sync-btn" class="sync-btn-sidebar" title="Sincronizar Agora">Sincronizar Agora</button>
                    </div>
                </div>
            </div>
        </div>

        <main id="main-content">
            <!-- HOME VIEW -->
            <div id="view-home" class="app-view active">
                <div class="info-cards-grid">
                    <!-- SEÇÃO 1: SALÁRIO E DESPESAS GERAIS -->
                    <!-- 1. Entrada de Salários -->
                    <div id="card-salary" class="summary-card">
                        <div class="summary-header"><div class="summary-title">Entrada de Salários</div></div>
                        <div id="salaryIncome" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="salaryIncomeProgressBar" class="summary-progress-bar-inner income"></div></div>
                        <div id="salaryIncomeSubtitle" class="summary-details"></div>
                    </div>

                    <!-- 2. Despesas Fixas e Variáveis -->
                    <div id="card-expenses" class="summary-card">
                        <div class="summary-header"><div class="summary-title">Despesas Fixas e Variáveis</div></div>
                        <div id="fixedVariableExpenses" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="fixedVariableExpensesProgressBar" class="summary-progress-bar-inner expense"></div></div>
                        <div id="fixedVariableExpensesSubtitle" class="summary-details"></div>
                    </div>

                    <!-- 3. Restante do Salário -->
                    <div id="card-remainder" class="summary-card">
                        <div class="summary-header"><div class="summary-title">Restante do Salário</div></div>
                        <div id="salaryRemainder" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="salaryRemainderProgressBar" class="summary-progress-bar-inner income"></div></div>
                        <div id="salaryRemainderSubtitle" class="summary-details"></div>
                    </div>

                    <!-- SEPARADOR -->
                    <div class="card-separator"></div>

                    <!-- SEÇÃO 2: MUMBUCA -->
                    <!-- 4. Entrada de Mumbuca -->
                    <div id="card-mumbuca-income" class="summary-card">
                        <div class="summary-header"><div class="summary-title">Entrada Mumbuca</div></div>
                        <div id="mumbucaIncome" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="mumbucaIncomeProgressBar" class="summary-progress-bar-inner income"></div></div>
                        <div id="mumbucaIncomeSubtitle" class="summary-details"></div>
                    </div>

                    <!-- 5. Gastos com Mumbuca -->
                    <div id="card-mumbuca-expenses" class="summary-card">
                        <div class="summary-header"><div class="summary-title">Gastos com Mumbuca</div></div>
                        <div id="mumbucaExpenses" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="mumbucaExpensesProgressBar" class="summary-progress-bar-inner expense"></div></div>
                        <div id="mumbucaExpensesSubtitle" class="summary-details"></div>
                    </div>

                    <!-- 6. Saldo de Mumbuca -->
                    <div id="card-mumbuca-balance" class="summary-card">
                        <div class="summary-header"><div class="summary-title">Saldo Mumbuca</div></div>
                        <div id="mumbucaBalance" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="mumbucaBalanceProgressBar" class="summary-progress-bar-inner income"></div></div>
                        <div id="mumbucaBalanceSubtitle" class="summary-details"></div>
                    </div>
                    
                    <!-- TOTAL GERAL (APENAS REFERÊNCIA) -->
                    <div class="summary-card">
                        <div class="summary-header"><div class="summary-title">Entrada Geral (Total)</div></div>
                        <div id="generalIncome" class="summary-value-small">R$ 0,00</div>
                        <div class="summary-progress-bar"><div id="generalIncomeProgressBar" class="summary-progress-bar-inner income"></div></div>
                        <div id="generalIncomeSubtitle" class="summary-details"></div>
                    </div>
                </div>

                <div id="debtSummaryContainer"></div>

                <div id="monthlyAnalysisSection" class="section">
                    <div class="section-header">
                        <h2 class="section-title">Análise do Mês</h2>
                    </div>
                    <div class="analysis-content">
                        <div class="analysis-block">
                            <h3 class="analysis-block-title">Maiores Despesas (Pagas)</h3>
                            <div id="overviewChart"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LANÇAMENTOS VIEW -->
            <div id="view-lancamentos" class="app-view">
                <div class="segmented-control">
                    <button class="segmented-btn active" data-list="incomes">Entradas</button>
                    <button class="segmented-btn" data-list="expenses">Despesas</button>
                    <button class="segmented-btn" data-list="compras-mumbuca">Compras Mumbuca</button>
                    <button class="segmented-btn" data-list="abastecimento-mumbuca">Abastecimento</button>
                    <button class="segmented-btn" data-list="avulsos">Avulsos</button>
                </div>

                <div class="lists-container">
                    <div id="list-incomes" class="list-view">
                        <div id="list-actions"><button class="btn" id="add-income-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Nova Entrada</button></div>
                        <div class="items-list-wrapper"><div id="incomesList" class="items-list"></div></div>
                    </div>
                    <div id="list-expenses" class="list-view" style="display: none;">
                        <div id="list-actions"><button class="btn" id="add-expense-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Nova Despesa</button></div>
                        <div class="items-list-wrapper"><div id="expensesList" class="items-list"></div></div>
                    </div>
                    <div id="list-compras-mumbuca" class="list-view" style="display: none;">
                        <div id="list-actions"><button class="btn" id="add-compras-mumbuca-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Nova Compra</button></div>
                        <div class="items-list-wrapper"><div id="comprasMumbucaList" class="items-list"></div></div>
                    </div>
                    <div id="list-abastecimento-mumbuca" class="list-view" style="display: none;">
                        <div id="list-actions"><button class="btn" id="add-abastecimento-mumbuca-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Novo Abastecimento</button></div>
                        <div class="items-list-wrapper"><div id="abastecimentoMumbucaList" class="items-list"></div></div>
                    </div>
                    <div id="list-avulsos" class="list-view" style="display: none;">
                        <div id="list-actions"><button class="btn" id="add-avulso-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Nova Despesa Avulsa</button></div>
                        <div class="items-list-wrapper"><div id="avulsosList" class="items-list"></div></div>
                    </div>
                </div>
            </div>

            <!-- METAS VIEW -->
            <div id="view-metas" class="app-view">
                 <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">Metas de Gastos</h2>
                        <button class="btn" id="add-goal-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Nova Meta</button>
                    </div>
                    <div id="goalsList" class="goals-list"></div>
                </div>
                 <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">Metas de Poupança</h2>
                        <button class="btn" id="add-savings-goal-btn"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>Nova Meta</button>
                    </div>
                    <div id="savingsGoalsList" class="goals-list"></div>
                </div>
            </div>
        </main>

        <nav id="tab-bar">
            <button class="tab-btn active" data-view="home">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                <span>Início</span>
            </button>
            <button class="tab-btn" data-view="lancamentos">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>
                <span>Lançamentos</span>
            </button>
            <button class="tab-btn" data-view="metas">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="6"></circle><circle cx="12" cy="12" r="2"></circle></svg>
                <span>Metas</span>
            </button>
        </nav>

        <!-- MODALS -->
        <div id="addModal" class="modal">
            <div class="modal-content">
                <header class="modal-header">
                    <h2 id="addModalTitle" class="modal-title">Adicionar</h2>
                    <button class="action-btn close-modal-btn" title="Fechar">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </header>
                <form id="addForm">
                    <div class="form-group"><label for="description" class="form-label">Descrição</label><input type="text" id="description" name="description" class="form-input" required></div>
                    <div class="form-group"><label for="amount" class="form-label">Valor</label><input type="text" id="amount" name="amount" class="form-input" inputmode="decimal" required></div>
                    <div id="sourceAccountGroup" class="form-group"><label for="sourceAccount" class="form-label">Fonte do Pagamento</label><select id="sourceAccount" name="sourceAccount" class="form-select"></select></div>
                    <div id="typeGroup" class="form-group"><label for="type" class="form-label">Tipo</label><select id="type" name="type" class="form-select"><option value="fixed">Fixa</option><option value="variable">Variável</option></select></div>
                    <div id="categoryGroup" class="form-group"><label for="category" class="form-label">Categoria</label><select id="category" name="category" class="form-select"></select></div>
                    <div id="dateGroup" class="form-group" style="display: none;"><label id="transactionDateLabel" for="transactionDate" class="form-label">Data</label><input type="date" id="transactionDate" name="transactionDate" class="form-input"></div>
                    <div id="installmentsGroup" class="form-row">
                        <div class="form-group"><label for="currentInstallment" class="form-label">Parcela Atual</label><input type="number" id="currentInstallment" name="currentInstallment" class="form-input" placeholder="Ex: 2"></div>
                        <div class="form-group"><label for="totalInstallments" class="form-label">Total de Parcelas</label><input type="number" id="totalInstallments" name="totalInstallments" class="form-input" placeholder="Ex: 12"></div>
                    </div>
                    <div class="form-group-checkbox" id="cyclicGroup"><input type="checkbox" id="cyclic" name="cyclic"><label for="cyclic">Despesa Cíclica (Repete todo mês)</label></div>
                    <div class="modal-footer"><button type="submit" class="btn btn-large">Salvar</button></div>
                </form>
            </div>
        </div>
        
        <div id="editModal" class="modal">
             <div class="modal-content">
                <header class="modal-header">
                    <h2 id="editModalTitle" class="modal-title">Editar</h2>
                    <button class="action-btn close-modal-btn" title="Fechar">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </header>
                <form id="editForm">
                    <input type="hidden" id="editItemId" name="itemId">
                    <input type="hidden" id="editItemType" name="itemType">
                    <div class="form-group"><label for="editDescription" class="form-label">Descrição</label><input type="text" id="editDescription" name="description" class="form-input" required></div>
                    <div class="form-group"><label for="editAmount" class="form-label">Valor</label><input type="text" id="editAmount" name="amount" class="form-input" inputmode="decimal" required></div>
                    <div id="editSourceAccountGroup" class="form-group"><label for="editSourceAccount" class="form-label">Fonte do Pagamento</label><select id="editSourceAccount" name="sourceAccount" class="form-select"></select></div>
                    <div id="editCategoryGroup" class="form-group"><label for="editCategory" class="form-label">Categoria</label><select id="editCategory" name="category" class="form-select"></select></div>
                    <div id="editDueDateGroup" class="form-group"><label for="editDueDate" class="form-label">Vencimento</label><input type="date" id="editDueDate" name="dueDate" class="form-input"></div>
                    <div id="editPaidDateGroup" class="form-group"><label for="editPaidDate" class="form-label">Data de Pagamento</label><input type="date" id="editPaidDate" name="paidDate" class="form-input"></div>
                    <div id="editInstallmentsGroup" class="form-row">
                        <div class="form-group"><label for="editCurrentInstallment" class="form-label">Parcela Atual</label><input type="number" id="editCurrentInstallment" name="currentInstallment" class="form-input"></div>
                        <div class="form-group"><label for="editTotalInstallments" class="form-label">Total</label><input type="number" id="editTotalInstallments" name="totalInstallments" class="form-input"></div>
                    </div>
                    <p id="editInstallmentsInfo" style="display:none; text-align: center; color: var(--text-light); font-size: 0.8rem; margin-top: -0.5rem; margin-bottom: 1rem;">Alterar as parcelas aqui não afeta os meses futuros.</p>
                    <div class="modal-footer">
                        <button type="button" id="deleteItemBtn" class="btn btn-danger">Excluir</button>
                        <button type="submit" class="btn">Salvar</button>
                    </div>
                </form>
            </div>
        </div>
        
        <div id="aiModal" class="modal">
            <div class="modal-content">
                <header class="modal-header">
                    <h2 id="aiModalTitle" class="modal-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3c-1.2 0-2.4.6-3 1.7A3.6 3.6 0 0 0 8.3 9c.5 1.1 1.4 2 2.7 2s2.2-.9 2.7-2c.1-.4.2-.8.3-1.3.6-1.1 0-2.3-1-3.1-.3-.2-.6-.3-1-.3z"></path><path d="M12 21c-1.2 0-2.4-.6-3-1.7A3.6 3.6 0 0 1 8.3 15c.5-1.1 1.4-2 2.7-2s2.2.9 2.7 2c.1.4.2.8.3 1.3.6 1.1 0 2.3-1 3.1-.3-.2-.6-.3-1 .3z"></path><path d="M3 12c0-1.2.6-2.4 1.7-3A3.6 3.6 0 0 1 9 8.3c1.1.5 2 1.4 2 2.7s-.9 2.2-2 2.7c.4.1.8.2-1.3.3-1.1.6-2.3 0-3.1-1 .2-.3-.3-.6-.3-1z"></path><path d="M21 12c0-1.2-.6-2.4-1.7-3A3.6 3.6 0 0 0 15 8.3c-1.1.5-2 1.4-2 2.7s.9 2.2 2 2.7c.4.1.8.2 1.3.3 1.1.6 2.3 0-3.1-1 .2-.3.3-.6-.3-1z"></path></svg>
                        Análise com IA
                    </h2>
                    <button class="action-btn close-modal-btn" title="Fechar">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </header>
                <div id="aiAnalysis"></div>
                <div class="modal-footer ai-footer">
                    <div id="aiSuggestionChips" class="ai-suggestion-chips">
                        <button id="generateSavingsSuggestionBtn" class="suggestion-chip">Dicas de economia</button>
                    </div>
                    <form id="aiChatForm">
                        <input type="text" id="aiChatInput" class="form-input" placeholder="Faça uma pergunta...">
                        <button type="submit" id="aiChatSendBtn" class="btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <div id="goalModal" class="modal">
             <div class="modal-content">
                <header class="modal-header"><h2 id="goalModalTitle" class="modal-title">Meta de Gastos</h2><button class="action-btn close-modal-btn">&times;</button></header>
                <form id="goalForm">
                    <input type="hidden" id="goalId" name="goalId">
                    <div class="form-group"><label for="goalCategory" class="form-label">Categoria</label><select id="goalCategory" name="goalCategory" class="form-select" required></select></div>
                    <div class="form-group"><label for="goalAmount" class="form-label">Valor Limite (R$)</label><input type="text" id="goalAmount" name="goalAmount" class="form-input" required inputmode="decimal"></div>
                    <div class="modal-footer"><button type="submit" class="btn btn-large">Salvar Meta</button></div>
                </form>
            </div>
        </div>

        <div id="savingsGoalModal" class="modal">
            <div class="modal-content">
                <header class="modal-header"><h2 id="savingsGoalModalTitle">Meta de Poupança</h2><button class="action-btn close-modal-btn">&times;</button></header>
                <form id="savingsGoalForm">
                    <input type="hidden" id="savingsGoalId" name="savingsGoalId">
                    <div class="form-group"><label for="savingsGoalDescription">Descrição</label><input type="text" id="savingsGoalDescription" name="savingsGoalDescription" class="form-input" required></div>
                    <div class="form-row">
                        <div class="form-group"><label for="savingsGoalCurrent">Valor Atual (R$)</label><input type="text" id="savingsGoalCurrent" name="savingsGoalCurrent" class="form-input" required inputmode="decimal"></div>
                        <div class="form-group"><label for="savingsGoalTarget">Objetivo (R$)</label><input type="text" id="savingsGoalTarget" name="savingsGoalTarget" class="form-input" required inputmode="decimal"></div>
                    </div>
                    <div class="modal-footer"><button type="submit" class="btn btn-large">Salvar Meta</button></div>
                </form>
            </div>
        </div>

        <div id="accountModal" class="modal">
            <div class="modal-content">
                <header class="modal-header"><h2 id="accountModalTitle">Conta Bancária</h2><button class="action-btn close-modal-btn">&times;</button></header>
                <form id="accountForm">
                    <input type="hidden" id="accountId" name="accountId">
                    <div class="form-group"><label for="accountName">Nome da Conta</label><input type="text" id="accountName" name="accountName" class="form-input" required></div>
                    <div class="form-group"><label for="accountBalance">Saldo (R$)</label><input type="text" id="accountBalance" name="accountBalance" class="form-input" required inputmode="decimal"></div>
                    <div class="modal-footer"><button type="submit" class="btn btn-large">Salvar Conta</button></div>
                </form>
            </div>
        </div>

    </div>
    <script type="module" src="index.tsx"></script>
</body>
</html>